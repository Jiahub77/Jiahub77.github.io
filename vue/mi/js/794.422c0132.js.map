{"version":3,"file":"js/794.422c0132.js","mappings":"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","sources":["webpack://myvuex/./src/views/Car/CarView.vue","webpack://myvuex/src/views/Car/CarView.vue","webpack://myvuex/./src/views/Car/CarView.vue?7723","webpack://myvuex/./src/views/Car/CarView.vue?9719"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('header',[_vm._v(\"购物车\")]),_vm._l((_vm.list),function(item,index){return _c('div',{key:index,staticClass:\"car\"},[_c('div',{staticClass:\"check\"},[_c('van-checkbox',{attrs:{\"checked-color\":\"#ee0a24\"},on:{\"change\":function($event){return _vm.setChecked(item[0].name)}},model:{value:(item.ischecked),callback:function ($$v) {_vm.$set(item, \"ischecked\", $$v)},expression:\"item.ischecked\"}})],1),_c('van-swipe-cell',{scopedSlots:_vm._u([{key:\"right\",fn:function(){return [_c('van-button',{staticClass:\"delete-button\",attrs:{\"square\":\"\",\"text\":\"删除\",\"type\":\"danger\"},on:{\"click\":function($event){return _vm.remove(item)}}})]},proxy:true}],null,true)},[_c('van-card',{staticClass:\"goods-card\",attrs:{\"price\":item[0].price,\"title\":item[0].name,\"thumb\":item[0].img_url},on:{\"click\":function($event){return _vm.$router.push({\n            path: '/productdetails',\n            query: {\n              product_id: item[0].product_id,\n            },\n          })}}}),_c('div',{staticClass:\"btn\"},[_c('van-stepper',{attrs:{\"theme\":\"round\",\"button-size\":\"22\",\"disable-input\":\"\"},on:{\"plus\":function($event){return _vm.setAddCount(item[0].product_id)},\"minus\":function($event){return _vm.setRedCount(item[0].product_id)}},model:{value:(item.count),callback:function ($$v) {_vm.$set(item, \"count\", $$v)},expression:\"item.count\"}})],1)],1)],1)}),_c('van-submit-bar',{attrs:{\"price\":_vm.price,\"button-text\":\"提交订单\"},on:{\"submit\":_vm.onSubmit}},[_c('van-checkbox',{attrs:{\"checked-color\":\"#ee0a24\"},on:{\"click\":_vm.allChecked},model:{value:(_vm.checked),callback:function ($$v) {_vm.checked=$$v},expression:\"checked\"}},[_vm._v(\"全选\")])],1)],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <header>购物车</header>\n    <div class=\"car\" v-for=\"(item, index) in list\" :key=\"index\">\n      <!-- 购物车产品 -->\n      <div class=\"check\">\n        <!-- <input\n          type=\"checkbox\"\n          v-model=\"item.ischecked\"\n          @click=\"setChecked(item[0].name)\"\n        /> -->\n        <van-checkbox\n          checked-color=\"#ee0a24\"\n          v-model=\"item.ischecked\"\n          @change=\"setChecked(item[0].name)\"\n        ></van-checkbox>\n      </div>\n      <van-swipe-cell>\n        <van-card\n          :price=\"item[0].price\"\n          :title=\"item[0].name\"\n          class=\"goods-card\"\n          :thumb=\"item[0].img_url\"\n          @click=\"\n            $router.push({\n              path: '/productdetails',\n              query: {\n                product_id: item[0].product_id,\n              },\n            })\n          \"\n        />\n        <template #right>\n          <van-button\n            square\n            text=\"删除\"\n            type=\"danger\"\n            @click=\"remove(item)\"\n            class=\"delete-button\"\n          />\n        </template>\n        <div class=\"btn\">\n          <van-stepper\n            v-model=\"item.count\"\n            theme=\"round\"\n            button-size=\"22\"\n            disable-input\n            @plus=\"setAddCount(item[0].product_id)\"\n            @minus=\"setRedCount(item[0].product_id)\"\n          />\n        </div>\n      </van-swipe-cell>\n    </div>\n    <van-submit-bar :price=\"price\" button-text=\"提交订单\" @submit=\"onSubmit\">\n      <van-checkbox\n        v-model=\"checked\"\n        checked-color=\"#ee0a24\"\n        @click=\"allChecked\"\n        >全选</van-checkbox\n      >\n    </van-submit-bar>\n  </div>\n</template>\n\n<script>\nimport { mapMutations, mapState } from \"vuex\";\n\nexport default {\n  data() {\n    return {\n      checked: false,\n    };\n  },\n  computed: {\n    ...mapState([\"carList\", \"token\", \"orderList\"]),\n    // 购物车列表\n    list() {\n      return this.carList.filter((item) => {\n        return this.token === item.token;\n      });\n    },\n    // 价格\n    price() {\n      let total = 0;\n      // 使用 reduce 方法累加价格\n      total = this.list.reduce((acc, item) => {\n        if (item.ischecked) {\n          // 确保 item[0] 和 item.price 存在\n          if (item[0] && item[0].price && item.count === 1) {\n            return acc + Number(item[0].price);\n          } else if (item[0] && item[0].price && item.count > 1) {\n            return acc + Number(item[0].price) * item.count;\n          }\n        }\n        return acc;\n      }, 0);\n      return total * 100;\n    },\n  },\n  methods: {\n    ...mapMutations([\"updateCar\", \"updateOrder\"]),\n    // 删除\n    remove(list) {\n      let newCarList = this.carList.filter((item) => {\n        return JSON.stringify(item) !== JSON.stringify(list);\n      });\n      // console.log(newCarList);\n      localStorage.setItem(\"carList\", JSON.stringify(newCarList));\n      this.updateCar();\n    },\n    // 修改ischecked\n    setChecked(name) {\n      let setCarList = this.carList.map((item) => {\n        if (item[0].name === name) {\n          return { ...item, ischecked: item.ischecked };\n        }\n        return item;\n      });\n      localStorage.setItem(\"carList\", JSON.stringify(setCarList));\n\n      // 如果列表发生了变化才更新 localStorage\n      const newCarList = JSON.stringify(setCarList);\n      if (localStorage.getItem(\"carList\") !== newCarList) {\n        console.log(\"setCar\", setCarList);\n        localStorage.setItem(\"carList\", newCarList);\n        this.updateCar();\n      }\n      this.checked = this.list.every((item) => item.ischecked);\n    },\n    // 修改产品数量count\n    setAddCount(id) {\n      let setCarList = this.carList.map((item) => {\n        if (item[0].product_id === id) {\n          return { ...item, count: item.count + 1 };\n        }\n        return item;\n      });\n      // 确保在 DOM 更新完成后更新 localStorage\n      localStorage.setItem(\"carList\", JSON.stringify(setCarList));\n      this.updateCar();\n    },\n    setRedCount(id) {\n      let setCarList = this.carList.map((item) => {\n        if (item[0].product_id === id) {\n          return { ...item, count: item.count - 1 };\n        }\n        return item;\n      });\n      // 确保在 DOM 更新完成后更新 localStorage\n      localStorage.setItem(\"carList\", JSON.stringify(setCarList));\n      this.updateCar();\n    },\n    // 全选\n    allChecked() {\n      console.log(this.checked);\n\n      let setCarList = this.carList.map((item) => {\n        if (item.token === this.token) {\n          return { ...item, ischecked: this.checked };\n        }\n        return item;\n      });\n      localStorage.setItem(\"carList\", JSON.stringify(setCarList));\n      this.updateCar();\n    },\n    // 提交订单\n    onSubmit() {\n      let order_id = Date.now();\n      let order = this.list\n        .filter((item) => item.ischecked)\n        .map((item) => {\n          return {\n            price: item[0].price,\n            name: item[0].name,\n            img_url: item[0].img_url,\n            count: item.count,\n            product_id: item[0].product_id,\n          };\n        });\n      console.log(\"order\", order);\n\n      let addOrderList = [\n        ...this.orderList,\n        {\n          ...order,\n          token: this.token,\n          state: \"未支付\",\n          id: order_id,\n        },\n      ];\n      console.log(addOrderList);\n      localStorage.setItem(\"orderList\", JSON.stringify(addOrderList));\n      this.$router.push({\n        path: \"/buypage\",\n        query: {\n          order_id: order_id,\n        },\n      });\n      this.updateOrder();\n    },\n  },\n  \n  activated() {\n    // this.getCartRecom()\n    if (this.list.length === 0) {\n      this.checked = false;\n    } else {\n      this.checked = this.list.every((item) => item.ischecked);\n    }\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\nheader {\n  margin-top: 0px;\n  color: rgba(0, 0, 0, 0.8);\n  font-size: 18px;\n  font-weight: 600;\n  text-align: center;\n  padding: 0.3rem 0;\n}\n.car {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background: #fafafa;\n  margin: 10px 0px;\n  position: relative;\n  .check {\n    padding: 0 0.1rem;\n    input {\n      width: 0.4rem;\n      height: 0.4rem;\n      position: relative;\n    }\n  }\n  .btn {\n    position: absolute;\n    right: 0.4rem;\n    bottom: 0.3rem;\n  }\n}\n\n.goods-card {\n  margin: 0;\n}\n\n.delete-button {\n  height: 100%;\n}\n.van-swipe-cell {\n  margin-top: 0.2rem;\n}\n.van-card__content {\n  justify-content: space-around;\n}\n.van-card {\n  width: 90vw;\n  padding: 8px 16px 8px 0;\n}\n.van-submit-bar {\n  bottom: 62px;\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CarView.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CarView.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./CarView.vue?vue&type=template&id=aa75d568&scoped=true\"\nimport script from \"./CarView.vue?vue&type=script&lang=js\"\nexport * from \"./CarView.vue?vue&type=script&lang=js\"\nimport style0 from \"./CarView.vue?vue&type=style&index=0&id=aa75d568&prod&lang=less&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"aa75d568\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","_v","_l","list","item","index","key","staticClass","attrs","on","$event","setChecked","name","model","value","ischecked","callback","$$v","$set","expression","scopedSlots","_u","fn","remove","proxy","price","img_url","$router","push","path","query","product_id","setAddCount","setRedCount","count","onSubmit","allChecked","checked","staticRenderFns","data","computed","mapState","carList","filter","token","total","reduce","acc","Number","methods","mapMutations","newCarList","JSON","stringify","localStorage","setItem","updateCar","setCarList","map","getItem","console","log","every","id","order_id","Date","now","order","addOrderList","orderList","state","updateOrder","activated","length","component"],"sourceRoot":""}