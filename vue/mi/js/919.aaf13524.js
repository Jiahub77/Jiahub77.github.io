"use strict";(self["webpackChunkmyvuex"]=self["webpackChunkmyvuex"]||[]).push([[919],{2919:function(t,e,s){s.r(e),s.d(e,{default:function(){return p}});s(4114);var o=function(){var t=this,e=t._self._c;return t.order?e("div",{staticClass:"buy"},[e("header",[e("van-icon",{attrs:{name:"arrow-left",size:"20"},on:{click:t.giveUp}}),e("div",{staticClass:"title"},[t._v("订单详情")]),e("van-dialog",{attrs:{"show-cancel-button":""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}})],1),t.contact?e("van-contact-card",{attrs:{type:"edit",name:t.contact.name,tel:t.contact.tel}}):e("van-contact-card",{attrs:{type:"add"},on:{click:t.showPopup}}),e("van-popup",{style:{height:"60%","padding-top":"16px"},attrs:{round:"",position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[e("van-contact-list",{attrs:{list:t.list,"default-tag-text":"默认"},on:{add:t.onAdd,edit:t.onEdit,select:t.onSelect},model:{value:t.chosenContactId,callback:function(e){t.chosenContactId=e},expression:"chosenContactId"}})],1),e("van-popup",{style:{height:"60%","padding-top":"16px"},attrs:{round:"",position:"bottom"},model:{value:t.showLink,callback:function(e){t.showLink=e},expression:"showLink"}},[e("van-address-edit",{attrs:{"area-list":t.areaList,"show-postal":"","show-delete":"","show-set-default":"","show-search-result":"","search-result":t.searchResult,"area-columns-placeholder":["请选择","请选择","请选择"]},on:{save:t.onSave,delete:t.onDelete,"change-detail":t.onChangeDetail}})],1),e("div",{staticClass:"product"},[t._l(t.filterObj,(function(s,o){return e("van-swipe-cell",{key:o},[e("van-card",{staticClass:"goods-card",attrs:{price:s?.price,title:s.name,thumb:s.img_url,num:s.count||t.order.count},on:{click:function(e){return t.$router.push({path:"/productdetails",query:{product_id:s.product_id}})}}})],1)})),t._m(0),e("div",{staticClass:"serve"},[e("div",[t._v("订单编号")]),e("div",[e("span",[t._v(t._s(t.order.id)+" |")]),t._v(" 复制 ")])])],2),e("div",{staticClass:"product"},[e("p",{staticClass:"price"},[t._v("价格")]),e("div",{staticClass:"serve"},[e("div",[t._v(" 商品总价 "),e("span",[t._v("共"+t._s(t.order.count||t.Allcount)+"件宝贝")])]),e("div",[t._v("￥"+t._s(t.order.price||t.total))])]),e("div",{staticClass:"serve"},[e("div",[t._v("合计")]),e("div",[t._v("￥"+t._s(t.total))])])]),e("van-submit-bar",{attrs:{price:100*t.total,"button-text":"提交订单"},on:{submit:t.onSubmit}}),e("van-popup",{style:{height:"50%","padding-top":"16px"},attrs:{round:"",position:"bottom"},model:{value:t.psw,callback:function(e){t.psw=e},expression:"psw"}},[e("van-password-input",{attrs:{value:t.value,focused:t.showKeyboard},on:{focus:function(e){t.showKeyboard=!0}}}),e("van-number-keyboard",{attrs:{show:t.showKeyboard},on:{blur:function(e){t.showKeyboard=!1}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)],1):t._e()},a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"serve"},[e("div",[t._v("配送服务")]),e("div",[e("div",[t._v("快递 免邮")]),e("div",[t._v("预计24小时内发货")])])])}],i=(s(8992),s(4520),s(2577),s(3949),s(1454),s(3518)),r=s(4380),n=s(1981),l=s(4639),c={components:{[r.A.Component.name]:r.A.Component},data(){return{dialog:!1,show:!1,showLink:!1,contact:null,chosenContactId:"1",list:JSON.parse(localStorage.getItem("contactList"))||[],areaList:l.G,searchResult:[],psw:!1,value:"",showKeyboard:!0}},computed:{...(0,i.aH)(["orderList","carList"]),order(){return this.orderList.find((t=>t.id==this.$route.query.order_id))},filterObj(){return Object.values(this.order).filter((t=>{if("object"===typeof t)return t}))},total(){let t=0;return this.filterObj.forEach((e=>{t=parseFloat(e.price)+t})),t},Allcount(){let t=0;return this.filterObj.forEach((e=>{t=parseFloat(e.count)+t})),t}},watch:{value(t){let e=JSON.parse(localStorage.getItem("users")).filter((t=>t.token===this.token));if(6===t.length)if(this.contact)if(t==e[0].password){(0,n.A)("支付完成"),this.psw=!1;let t=this.orderList.map((t=>t.id==this.$route.query.order_id?{...t,state:"已支付"}:t));localStorage.setItem("orderList",JSON.stringify(t));let e=this.carList.filter((t=>!t.ischecked));localStorage.setItem("carList",JSON.stringify(e)),this.updateCar(),this.$router.replace("/orderdetail"),this.updateOrder()}else(0,n.A)("密码错误"),this.value="";else(0,n.A)("请填写联系人"),this.psw=!1,this.value=""}},methods:{...(0,i.PY)(["updateOrder","updateCar"]),showPopup(){this.show=!0},onAdd(){this.show=!1,this.showLink=!0},onEdit(t){(0,n.A)("编辑"+t.id)},onSelect(t){(0,n.A)("你好"+t.name),this.show=!1,this.contact={areaCode:t.areaCode,city:t.city,country:t.country,county:t.county,isDefault:t.isDefault,name:t.name,postalCode:t.postalCode,province:t.province,tel:t.tel}},onSave(t){this.list=[...this.list,{...t}],console.log(this.list),localStorage.setItem("contactList",JSON.stringify(this.list)),this.showLink=!1,this.show=!0},onDelete(){(0,n.A)("delete")},onChangeDetail(t){this.searchResult=t?[{name:"黄龙万科中心",address:"杭州市西湖区"}]:[]},onSubmit(){this.psw=!0},giveUp(){r.A.confirm({message:"订单还未支付，确认退出吗"}).then((()=>{this.$router.back();let t=this.orderList.filter((t=>t.id!=this.$route.query.order_id));localStorage.setItem("orderList",JSON.stringify(t))})).catch((()=>{this.dialog=!1}))}}},d=c,u=s(1656),h=(0,u.A)(d,o,a,!1,null,"7d9a6aec",null),p=h.exports}}]);
//# sourceMappingURL=919.aaf13524.js.map